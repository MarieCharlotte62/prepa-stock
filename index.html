<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pr√©pa Stock</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header class="topbar">
    <div class="brand">
      <div class="logo">üì¶</div>
      <div>
        <div class="title">Pr√©pa Stock</div>
        <div class="subtitle">Saisie ‚Üí Pr√©pa ‚Üí Consommation</div>
      </div>
    </div>

    <div class="tabs">
      <!-- üî• Onglets Produits & Services retir√©s de l'UI (mais code conserv√©) -->
      <!-- <button class="tab" data-tab="products">Produits</button> -->
      <!-- <button class="tab" data-tab="services">Services</button> -->

      <button class="tab active" data-tab="dotations">Dotations</button>
      <button class="tab" data-tab="entry">Saisie</button>
      <button class="tab" data-tab="prep">Pr√©pa</button>
      <button class="tab" data-tab="consumption">Consommation</button>

      <button class="btn ghost" id="reloadAll" style="margin-left:auto;">‚Üª Recharger JSON</button>
    </div>

    <div class="muted" style="margin-top:8px" id="productsLoadStatus"></div>
  </header>

  <!-- ========== PANELS ========== -->

  <!-- (Cach√©s) Produits / Services : conserv√©s dans le code -->
  <section id="tab-products" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Produits</div>
            <div class="subtitle muted" id="productsCount"></div>
          </div>
        </div>
        <div class="tableWrap">
          <table class="table" id="productsTable">
            <thead>
              <tr>
                <th>Code</th><th>Nom</th><th>Cat√©gorie</th><th>U/carton</th><th>U/pack</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <section id="tab-services" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="title">Services</div>
        <div class="tableWrap">
          <table class="table" id="servicesTable">
            <thead>
              <tr><th>Service</th><th>Nb produits</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- Dotations -->
  <section id="tab-dotations" class="panel">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Dotations</div>
            <div class="subtitle muted">Ordre respect√© (dotations_order.json)</div>
          </div>
          <div class="inline">
            <select id="d_service"></select>
          </div>
        </div>

        <div class="tableWrap">
          <table class="table" id="dotationsTable">
            <thead>
              <tr><th>#</th><th>Code</th><th>Produit</th><th>Dotation (u)</th><th class="muted">√âquiv.</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="footnote muted">
          La dotation est stock√©e en unit√©s dans dotations.json.
        </div>
      </div>
    </div>
  </section>

  <!-- Saisie -->
  <section id="tab-entry" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Saisie</div>
            <div class="subtitle muted">Tu saisis uniquement Pack si U/pack > 0, sinon Unit√©s</div>
          </div>
          <div class="inline">
            <select id="e_service"></select>
            <button class="btn ghost" id="toggleFullscreenEntry">üîç Plein √©cran</button>
            <button class="btn ghost" id="clearEntry">üßπ Vider saisie</button>
          </div>
        </div>

        <div class="tableWrap">
          <table class="table" id="entryTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Code</th>
                <th>Produit</th>
                <th>Packs</th>
                <th>Unit√©s</th>
                <th>√Ä pr√©parer</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="footnote muted">
          Astuce : laisse vide = rien √† pr√©parer. Mets 0 = il n‚Äôy en a plus.
        </div>
      </div>
    </div>
  </section>

  <!-- Pr√©pa -->
  <section id="tab-prep" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Pr√©pa</div>
            <div class="subtitle muted" id="prepSummary"></div>
          </div>

          <div class="inline">
            <select id="p_service"></select>
            <button class="btn ghost" id="checkAll">‚úÖ Tout cocher</button>
            <button class="btn ghost" id="uncheckAll">‚Ü©Ô∏é Tout d√©cocher</button>
          </div>
        </div>

        <div class="row" style="margin-top:10px; gap:8px;">
          <button class="btn" id="closeSave">‚úÖ Cl√¥turer + sauvegarder</button>
          <button class="btn ghost" id="closeNoSave">üßπ Vider sans sauvegarder</button>
        </div>

        <div class="prepHeader">
          <div>Produit</div>
          <div class="right">√Ä pr√©parer</div>
          <div class="right">Pr√©par√©</div>
          <div class="center">Fait</div>
        </div>
        <div id="prepList" class="prepList"></div>

        <div class="footnote muted">
          Cl√¥turer + sauvegarder = enregistre la consommation (historique) puis remet √† z√©ro saisie/pr√©pa pour le service.
        </div>
      </div>
    </div>
  </section>

  <!-- Consommation -->
  <section id="tab-consumption" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Consommation</div>
            <div class="subtitle muted">Semaine / Mois ‚Ä¢ Tous services r√©unis</div>
          </div>

          <div class="inline" style="flex-wrap:wrap;">
            <select id="c_mode">
              <option value="week">Semaine</option>
              <option value="month">Mois</option>
            </select>
            <input id="c_date" type="date" />
            <button class="btn ghost" id="c_export">Exporter CSV</button>
            <button class="btn ghost" id="c_clear">Effacer historique</button>
          </div>
        </div>

        <div class="footnote muted" id="c_range"></div>

        <div class="tableWrap">
          <table class="table" id="c_table_products">
            <thead>
              <tr><th>Code</th><th>Produit</th><th>Total (u)</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="tableWrap">
          <table class="table" id="c_table_services">
            <thead>
              <tr><th>Service</th><th>Total (u)</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

      </div>
    </div>
  </section>

  <!-- Bandeau rappel SAISIE -->
  <div id="entryReminder" class="stickyReminder hidden">
    <strong>Rappel :</strong> prendre les feuilles √©picerie / di√©t√©tiques üßæ
  </div>

  <script src="app.js"></script>
</body>
</html>
