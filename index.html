<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Magasin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@600;700&family=Manrope:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header class="topbar">
    <div class="brand">
      <div class="logo">üì¶</div>
      <div>
        <div class="title">Magasin</div>
        <div class="subtitle"></div>
      </div>
    </div>

    <div class="tabs">
      <!-- üî• Onglets Produits & Services retir√©s de l'UI (mais code conserv√©) -->
      <!-- <button class="tab" data-tab="products">Produits</button> -->
      <!-- <button class="tab" data-tab="services">Services</button> -->

      <button class="tab active" data-tab="planning">Planning</button>
      <button class="tab" data-tab="epi">EPI</button>
      <button class="tab" data-tab="order">Commande</button>
      <button class="tab" data-tab="dotations">Dotations</button>
      <button class="tab" data-tab="entry">Compl√©ment</button>
      <button class="tab" data-tab="prep">Pr√©par.</button>
      <button class="tab" data-tab="consumption">Consommation</button>

      <div class="menuWrap">
        <button class="menuToggle" id="moreMenuToggle" aria-haspopup="true" aria-expanded="false">...</button>
        <div class="menu" id="moreMenu">
          <button class="menuItem" data-tab="epi">EPI</button>
          <button class="menuItem" data-tab="order">Commande</button>
          <button class="menuItem" data-tab="dotations">Dotations</button>
          <button class="menuItem" data-tab="consumption">Consommation</button>
        </div>
      </div>
    </div>

    <div class="statusBar muted" id="productsLoadStatus"></div>
  </header>

  <!-- ========== PANELS ========== -->
  <!-- Planning -->
  <section id="tab-planning" class="panel">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Planning</div>
            <div class="subtitle muted">T√¢ches hebdomadaires par service</div>
          </div>
        </div>

        <div class="subtabs">
          <button class="subtab active" data-plan="hospital">H√¥pital</button>
          <button class="subtab" data-plan="ehpad">EHPAD</button>
          <button class="btn ghost planningClear" id="planningClear">Tout d√©cocher</button>
        </div>

        <div id="planningContent" class="planningContent"></div>
      </div>
    </div>
  </section>

  <!-- EPI -->
  <section id="tab-epi" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">EPI</div>
            <div class="subtitle muted">Suivi des stocks</div>
          </div>
        </div>

        <div class="tableWrap">
          <table class="table" id="epiTable">
            <colgroup>
              <col />
              <col style="width:130px" />
              <col style="width:130px" />
              <col style="width:110px" />
            </colgroup>
            <thead>
              <tr>
                <th>D√©signation</th>
                <th>Stock EHPAD</th>
                <th>Stock H√¥pital</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- Commande -->
  <section id="tab-order" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Commande</div>
            <div class="subtitle muted">Seuils + s√©lection √† commander</div>
          </div>
        </div>

        <div class="subtabs orderSubtabs">
          <button class="subtab active" data-order="hospital">H√¥pital</button>
          <button class="subtab" data-order="ehpad">EHPAD</button>
        </div>

        <div class="tableWrap orderTableWrap">
          <table class="table" id="orderTable">
            <colgroup>
              <col style="width:72px" />
              <col />
              <col style="width:76px" />
              <col style="width:64px" />
            </colgroup>
            <thead>
              <tr>
                <th>Code</th>
                <th>Produit</th>
                <th>Qt√©</th>
                <th>√Ä cmd</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="row space" style="margin-top:14px">
          <div class="title" style="font-size:14px">Produits √† commander</div>
        </div>
        <div class="tableWrap">
          <table class="table" id="orderListTable">
            <colgroup>
              <col style="width:90px" />
              <col />
            </colgroup>
            <thead>
              <tr>
                <th>Code</th>
                <th>Produit</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- (Cach√©s) Produits / Services : conserv√©s dans le code -->
  <section id="tab-products" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Produits</div>
            <div class="subtitle muted" id="productsCount"></div>
          </div>
        </div>
        <div class="tableWrap">
          <table class="table" id="productsTable">
            <colgroup>
              <col style="width:110px" />
              <col />
              <col style="width:140px" />
              <col style="width:90px" />
              <col style="width:90px" />
            </colgroup>
            <thead>
              <tr>
                <th>Code</th><th>Nom</th><th>Cat√©gorie</th><th>U/carton</th><th>U/pack</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <section id="tab-services" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="title">Services</div>
        <div class="tableWrap">
          <table class="table" id="servicesTable">
            <colgroup>
              <col />
              <col style="width:120px" />
            </colgroup>
            <thead>
              <tr><th>Service</th><th>Nb produits</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- Dotations -->
  <section id="tab-dotations" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Dotations</div>
            <div class="subtitle muted">Ordre respect√© (dotations_order.json)</div>
          </div>
          <div class="inline">
            <select id="d_service"></select>
          </div>
        </div>

        <div class="tableWrap">
          <table class="table" id="dotationsTable">
            <thead>
              <tr><th>#</th><th>Code</th><th>Produit</th><th>Qt√©</th><th class="muted">Unt</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="footnote muted">
          La dotation est stock√©e en unit√©s dans dotations.json.
        </div>
      </div>
    </div>
  </section>

  <!-- Saisie -->
  <section id="tab-entry" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Compl√©ment</div>
            <div class="subtitle muted">Tu saisis uniquement Pack si U/pack > 0, sinon Unit√©s</div>
          </div>
          <div class="inline">
            <select id="e_service"></select>
            <button class="btn ghost" id="toggleFullscreenEntry">üîç Plein √©cran</button>
            <button class="btn ghost" id="clearEntry">üßπ Vider saisie</button>
          </div>
        </div>

        <div class="tableWrap">
          <table class="table" id="entryTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Code</th>
                <th>Produit</th>
                <th>Packs</th>
                <th>Unit√©s</th>
                <th>Qt√©</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="footnote muted">
          Astuce : laisse vide = rien √† pr√©parer. Mets 0 = il n‚Äôy en a plus.
        </div>
      </div>
    </div>
  </section>

  <!-- Pr√©par. -->
  <section id="tab-prep" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Pr√©par.</div>
            <div class="subtitle muted" id="prepSummary"></div>
          </div>

          <div class="inline">
            <select id="p_service"></select>
            <button class="btn ghost" id="checkAll">‚úÖ Tout cocher</button>
            <button class="btn ghost" id="uncheckAll">‚Ü©Ô∏é Tout d√©cocher</button>
          </div>
        </div>

        <div class="row" style="margin-top:10px; gap:8px;">
          <button class="btn" id="closeSave">‚úÖ Cl√¥turer + sauvegarder</button>
          <button class="btn ghost" id="closeNoSave">üßπ Vider sans sauvegarder</button>
        </div>

        <div class="tableWrap prepWrap">
          <div class="prepHeader">
            <div>Produit</div>
            <div class="right">√Ä pr√©parer</div>
            <div class="right">Pr√©par√©</div>
            <div class="center">Fait</div>
          </div>
          <div id="prepList" class="prepList"></div>
        </div>

        <div class="footnote muted">
          Cl√¥turer + sauvegarder = enregistre la consommation (historique) puis remet √† z√©ro saisie/pr√©pa pour le service.
        </div>
      </div>
    </div>
  </section>

  <!-- Consommation -->
  <section id="tab-consumption" class="panel hidden">
    <div class="container">
      <div class="card">
        <div class="row space">
          <div>
            <div class="title">Consommation</div>
            <div class="subtitle muted">Semaine / Mois ‚Ä¢ Tous services r√©unis</div>
          </div>

          <div class="inline" style="flex-wrap:wrap;">
            <select id="c_mode">
              <option value="week">Semaine</option>
              <option value="month">Mois</option>
            </select>
            <input id="c_date" type="date" />
            <button class="btn ghost" id="c_export">Exporter CSV</button>
            <button class="btn ghost" id="c_clear">Effacer historique</button>
          </div>
        </div>

        <div class="footnote muted" id="c_range"></div>

        <div class="tableWrap">
          <table class="table" id="c_table_products">
            <colgroup>
              <col style="width:100px" />
              <col />
              <col style="width:110px" />
            </colgroup>
            <thead>
              <tr><th>Code</th><th>Produit</th><th>Total (u)</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="tableWrap">
          <table class="table" id="c_table_services">
            <colgroup>
              <col />
              <col style="width:110px" />
            </colgroup>
            <thead>
              <tr><th>Service</th><th>Total (u)</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

      </div>
    </div>
  </section>

  <!-- Bandeau rappel SAISIE -->
  <div id="entryReminder" class="stickyReminder hidden">
    <strong>Rappel :</strong> pr√©voir les feuilles √©picerie et di√©t√©tiques.
  </div>

  <script src="app.js"></script>
</body>
</html>
